# Q-RRT* 路径规划算法实现

这是 Q-RRT* (Quasi-RRT*) 路径规划算法的 Python 实现，是 RRT* 算法的一种改进版本，通过考虑节点祖先来提高路径质量和收敛速度。该实现包含可视化界面，允许用户交互式地绘制障碍物、设置起点和终点，并观察算法的运行过程。

## 功能特性

- 交互式界面，支持手动绘制障碍物
- 可视化 RRT* 树的扩展过程
- 路径优化和重连功能
- 结果保存功能（截图和Excel数据）
- 实时显示算法性能指标

## 算法概述

Q-RRT* 是 RRT* 算法的一种改进，主要改进点包括：

1. **祖先考虑**：在选择最佳父节点时，不仅考虑邻近节点，还考虑其祖先节点
2. **多级重连**：尝试通过新节点或其父节点重连邻近节点，优化树结构
3. **目标偏置采样**：增加采样点倾向于目标点的概率，加速收敛

## 安装依赖

运行此程序需要安装以下 Python 库：

```bash
pip install pygame pandas
```

## 使用方法

1. 运行主程序：
   ```bash
   python 10_20_QRRT_3.PY
   ```

2. 按照界面提示操作：
   - **绘制障碍物**：在空白区域拖动鼠标绘制黑色障碍物
   - **设置起点**：点击按钮后在地图上设置红色起点
   - **设置终点**：点击按钮后在地图上设置绿色终点
   - **运行算法**：点击按钮开始运行 Q-RRT* 算法
   - **重置**：随时可以点击重置按钮重新开始

3. 算法运行过程中，程序会：
   - 实时显示算法状态和性能指标
   - 自动保存路径发现和优化的截图
   - 将运行结果保存到 Excel 文件中

## 代码结构

- **常量与配置**：定义了屏幕尺寸、颜色、算法参数等
- **类定义**：包含 Button 类用于 UI 交互
- **辅助函数**：提供距离计算、碰撞检测、路径点生成等功能
- **核心算法**：实现 Q-RRT* 算法的主要逻辑
- **绘图函数**：负责场景和 UI 元素的绘制
- **主函数**：程序的入口点，处理事件循环和状态管理

## 结果保存

程序会自动在运行目录下创建两个文件夹：

- `QRRT_screenshots`：保存算法运行过程的截图
- `QRRT_results`：保存算法运行结果的 Excel 文件

Excel 文件包含以下数据：
- 时间戳
- 算法名称
- 障碍物数量
- 节点数量
- 路径长度
- 算法运行时间
- 优化迭代次数
- 算法参数设置

## 参数调整

可以通过修改代码中的常量来调整算法性能：

- `STEP_SIZE`：扩展步长，控制每次扩展的距离
- `REWIRE_RADIUS`：重连半径，影响邻域搜索范围
- `DEPTH`：祖先搜索深度，影响 Q-RRT* 算法的搜索范围
- `GOAL_SAMPLING_PROBABILITY`：目标偏置概率，影响采样策略
- `MAX_OPTIMIZATION_ITERATIONS`：最大优化迭代次数
- `MAX_OPTIMIZATION_TIME`：最大优化时间（秒）

## 可视化说明

- **黑色圆点**：障碍物
- **红色圆点**：起点
- **绿色圆点**：终点
- **蓝色线条和点**：RRT* 树结构
- **亮绿色线条**：找到的最优路径

## 注意事项

- 确保在设置起点和终点时避开障碍物
- 复杂地图可能需要增加 `STEP_SIZE` 或减少 `REWIRE_RADIUS` 以提高性能
- 如果算法运行缓慢，可以调整代码中 `RUNNING_RRT` 和 `OPTIMIZING_PATH` 状态下每次迭代的次数

## 许可证

此项目为学习和研究目的而创建，可以自由使用和修改。